# This file was automagically generated by mbed.org. For more information, 
# see http://mbed.org/handbook/Exporting-to-GCC-ARM-Embedded

###############################################################################
# Scheduler type:
# - rm: Rate Monotonic
# - edf: Earliest Deadline First
# - dp: Dual Priority
# - ss: Slack Stealing
#
HST_SCHED ?= rm

###############################################################################
# FreeRTOS version supported.
# - v8.2.1
# - v9.0.0
FREERTOS_VERSION ?= v9.0.0

###############################################################################
# Supported boards for the examples:
# - lpc1768
# - nucleo_f411re
# - nucleo_f103rb
# - STM32F4DISCOVERY
BOARD ?= nucleo_f103rb

MBED_LIB_PATH = ./mbed/$(BOARD)
BIN_DIR = ./build

###############################################################################
PROJECT = hst
FREERTOS_OBJECTS = ./FreeRTOS/$(FREERTOS_VERSION)/tasks.o ./FreeRTOS/$(FREERTOS_VERSION)/queue.o ./FreeRTOS/$(FREERTOS_VERSION)/list.o ./FreeRTOS/$(FREERTOS_VERSION)/portable/MemMang/heap_1.o

ifeq ($(BOARD), lpc1768)
FREERTOS_OBJECTS += ./FreeRTOS/$(FREERTOS_VERSION)/portable/GCC/ARM_CM3/port.o
endif
ifeq ($(BOARD), nucleo_f103rb)
FREERTOS_OBJECTS += ./FreeRTOS/$(FREERTOS_VERSION)/portable/GCC/ARM_CM3/port.o
endif
ifeq ($(BOARD), nucleo_f411re)
FREERTOS_OBJECTS += ./FreeRTOS/$(FREERTOS_VERSION)/portable/GCC/ARM_CM4F/port.o
endif

HST_OBJECTS = ./hst/$(HST_SCHED)/scheduler_logic_$(HST_SCHED).o ./hst/scheduler.o ./hst/wcrt.o
EXAMPLE_OBJECTS = ./examples/$(HST_SCHED)/main.o ./examples/utils/utils.o
OBJECTS = $(FREERTOS_OBJECTS) $(HST_OBJECTS) $(EXAMPLE_OBJECTS)
ifeq ($(HST_SCHED), ss)
	OBJECTS += ./hst/$(HST_SCHED)/slack.o
endif

FREERTOS_INCLUDE_PATHS = -I./FreeRTOS/$(FREERTOS_VERSION)/include -I./FreeRTOS/$(FREERTOS_VERSION)/portable/GCC/ARM_CM3 -I./FreeRTOS/$(FREERTOS_VERSION)/config
HST_INCLUDE_PATHS = -I./hst -I./hst/$(HST_SCHED)
EXAMPLE_INCLUDE_PATHS = -I./examples/utils

############################################################################### 
GCC_BIN = 
AS      = $(GCC_BIN)arm-none-eabi-as
CC      = $(GCC_BIN)arm-none-eabi-gcc
CPP     = $(GCC_BIN)arm-none-eabi-g++
LD      = $(GCC_BIN)arm-none-eabi-gcc
OBJCOPY = $(GCC_BIN)arm-none-eabi-objcopy
OBJDUMP = $(GCC_BIN)arm-none-eabi-objdump
SIZE 	= $(GCC_BIN)arm-none-eabi-size

export AS CC CPP LD OBJCOPY SIZE BIN_DIR MBED_LIB_PATH PROJECT FREERTOS_VERSION FREERTOS_OBJECTS HST_OBJECTS EXAMPLE_OBJECTS OBJECTS FREERTOS_INCLUDE_PATHS HST_INCLUDE_PATHS EXAMPLE_INCLUDE_PATHS

all: $(BOARD)

lpc1768:
	@echo "Target board: lpc1768"
	@$(MAKE) -f Makefile_LPC1768.mk
	
lpc1768_clean:
	@echo "Target board: lpc1768"
	@$(MAKE) -f Makefile_LPC1768.mk clean
	
nucleo_f103rb:
	@echo "Target board: nucleo_f103rb"
	@$(MAKE) -f Makefile_nucleo_f103rb.mk
	
nucleo_f103rb_clean:
	@echo "Target board: nucleo_f103rb"
	@$(MAKE) -f Makefile_nucleo_f103rb.mk clean
	
nucleo_f411re:
	@echo "Target board: nucleo_f411re"
	@$(MAKE) -f Makefile_nucleo_f411re.mk
	
nucleo_f411re_clean:
	@echo "Target board: nucleo_f411re"
	@$(MAKE) -f Makefile_nucleo_f411re.mk clean
		
clean: $(BOARD)_clean
